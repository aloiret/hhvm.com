---
author: joelm
layout: post
title: 'Locking Down for Performance and Parity '
category: blog
permalink: /blog/1499/locking-down-for-performance-and-parity
comments:
- id: 1235
  author: Bob Brunius
  author_email: rbrunius@gmail.com
  author_url: http://yachtdestinations.org
  date: '2013-11-07 16:23:17 +0000'
  date_gmt: '2013-11-08 00:23:17 +0000'
  content: Is mysqli supported yet?
- id: 1241
  author: puentesdiaz
  author_email: puentesdiaz@gmail.com
  author_url: ''
  date: '2013-11-07 16:37:21 +0000'
  date_gmt: '2013-11-08 00:37:21 +0000'
  content: |-
    Hi there!
    Amazing work!  I hope that we can install this tool,  very soon over our servers ....
- id: 1247
  author: Kobbe
  author_email: kobbe82@hotmail.com
  author_url: ''
  date: '2013-11-07 22:31:53 +0000'
  date_gmt: '2013-11-08 06:31:53 +0000'
  content: Great work! will typo3 and the typo3 flow framework be supported?
- id: 1253
  author: Thomas Heidrich
  author_email: mail@gnuheidix.de
  author_url: http://gnuheidix.de/
  date: '2013-11-07 22:40:45 +0000'
  date_gmt: '2013-11-08 06:40:45 +0000'
  content: |-
    I'm looking forward to see HHVM in top row of the <a href="http:&#47;&#47;benchmarksgame.alioth.debian.org&#47;" rel="nofollow">Benchmarks Game<&#47;a>. :-)

    You guys give PHP a future. Keep up the good work.
- id: 1259
  author: qianzhihe
  author_email: do.not.reply@foxmail.com
  author_url: http://www.hhvm.cn
  date: '2013-11-07 22:57:08 +0000'
  date_gmt: '2013-11-08 06:57:08 +0000'
  content: "+1"
- id: 1265
  author: RouteXL
  author_email: info@routexl.com
  author_url: http://www.routexl.com/
  date: '2013-11-07 23:36:43 +0000'
  date_gmt: '2013-11-08 07:36:43 +0000'
  content: |-
    Movember lockdowns are the best. Have fun!

    <em>PS: No Sara mantra too?<&#47;em>
- id: 1271
  author: M&aacute;ximo Cuadros
  author_email: mcuadros@gmail.com
  author_url: ''
  date: '2013-11-07 23:46:27 +0000'
  date_gmt: '2013-11-08 07:46:27 +0000'
  content: |-
    Any idea when will be ready mongodb ext?

    Regards
- id: 1277
  author: Paul Tarjan
  author_email: pt@fb.com
  author_url: http://paultarjan.com/
  date: '2013-11-08 17:15:40 +0000'
  date_gmt: '2013-11-09 01:15:40 +0000'
  content: Their unit tests were too hard to run to add to our charts, but IIRC it
    worked well already. Did you try it?
- id: 1283
  author: Paul Tarjan
  author_email: pt@fb.com
  author_url: http://paultarjan.com/
  date: '2013-11-08 17:16:58 +0000'
  date_gmt: '2013-11-09 01:16:58 +0000'
  content: What should we do to get added there?
- id: 1289
  author: Nazar Mokrynskyi
  author_email: nazar-pc@yandex.ru
  author_url: http://cleverstyle.org
  date: '2013-11-09 11:39:19 +0000'
  date_gmt: '2013-11-09 19:39:19 +0000'
  content: |-
    How difficult is to add __call() and __callStatic() functions?
    I'm using such syntax:
    <code>h::{'section article.some-class[data-article=yes]'}()<&#47;code>
    And I need support of this in order to work with HHVM
- id: 1295
  author: Jim
  author_email: toyotabedzrock@gmail.com
  author_url: ''
  date: '2013-11-09 13:31:50 +0000'
  date_gmt: '2013-11-09 21:31:50 +0000'
  content: Have you tried alternate compilers at all? The Intel compiler, their threading
    libraries and their ipp libraries for zlib and openssl can speed up certain tasks
    dramatically.
- id: 1301
  author: Louie
  author_email: foronda@ymail.com
  author_url: ''
  date: '2013-11-10 04:39:29 +0000'
  date_gmt: '2013-11-10 12:39:29 +0000'
  content: laravel, twig, drupal for the win, hope to see this three working next
    month.. ^__^
- id: 1307
  author: Paul Tarjan
  author_email: pt@fb.com
  author_url: http://paultarjan.com/
  date: '2013-11-10 11:29:04 +0000'
  date_gmt: '2013-11-10 19:29:04 +0000'
  content: That should work already.
- id: 1313
  author: Paul Tarjan
  author_email: pt@fb.com
  author_url: http://paultarjan.com/
  date: '2013-11-10 11:29:43 +0000'
  date_gmt: '2013-11-10 19:29:43 +0000'
  content: We've experimented with a few. GCC 4.8 is currently the fastest for us.
- id: 1319
  author: Radu
  author_email: radu.murzea@gmail.com
  author_url: ''
  date: '2013-11-11 07:32:33 +0000'
  date_gmt: '2013-11-11 15:32:33 +0000'
  content: |-
    Actually, if I were you, I would focus strictly on the ability of HHVM to run (almosy) any piece of PHP code out there. Maybe on easier installation process too.

    Performance should be a lower priority. What good is it to have extreme performance if the most popular frameworks crash on it ? Like owning a Ferrari and not having gas money....
- id: 1325
  author: Martin
  author_email: martin.sonnenholzer@googlemail.com
  author_url: ''
  date: '2013-11-11 09:51:03 +0000'
  date_gmt: '2013-11-11 17:51:03 +0000'
  content: I didn't try it yet with flow is one of my next spare time projects to
    test typo3 flow and hhvm. But why are the unit test so difficult?
- id: 1331
  author: Bostjan
  author_email: bostjan.rihter@gmail.com
  author_url: ''
  date: '2013-11-11 11:18:39 +0000'
  date_gmt: '2013-11-11 19:18:39 +0000'
  content: Are there any plans for Kohana support?
- id: 1337
  author: Samuel Demirdjian
  author_email: s@enov.ws
  author_url: ''
  date: '2013-11-11 23:08:43 +0000'
  date_gmt: '2013-11-12 07:08:43 +0000'
  content: |-
    Another +1 for Kohana support here.

    Kohana stands out with his native HMVC and cascading file system. The community and core developers are very disciplined and I am sure we can work this out mutually with minimal overhead from your side, pleaaase :-)

    Thank you for efforts and for making PHP better.
- id: 1343
  author: jcoetz
  author_email: jon.mark.c@gmail.com
  author_url: ''
  date: '2013-11-12 05:48:00 +0000'
  date_gmt: '2013-11-12 13:48:00 +0000'
  content: Wow, next time please actually read the article...
- id: 1349
  author: Nathan Malcolm
  author_email: nmalcolm@hush.ai
  author_url: ''
  date: '2013-11-18 23:51:11 +0000'
  date_gmt: '2013-11-19 07:51:11 +0000'
  content: I do hope you'll be posting up a follow up article on how things went --
    performance changes, new features, improved parity, etc. :)
- id: 1355
  author: Josh
  author_email: joshuataylorx@gmail.com
  author_url: ''
  date: '2013-11-20 04:22:09 +0000'
  date_gmt: '2013-11-20 12:22:09 +0000'
  content: Would love a follow up as well!
- id: 1361
  author: Joel Marcey
  author_email: joelm@fb.com
  author_url: https://www.facebook.com/JoelMarcey
  date: '2013-11-21 00:10:44 +0000'
  date_gmt: '2013-11-21 08:10:44 +0000'
  content: Stay tuned. A post-lockdown post will be coming. :)
- id: 1367
  author: Josh
  author_email: joshuataylorx@gmail.com
  author_url: ''
  date: '2013-11-21 03:23:44 +0000'
  date_gmt: '2013-11-21 11:23:44 +0000'
  content: |-
    Hooray, thanks Joel.

    HHVM over the past few weeks has been exciting to see the spate of commits on Github!
- id: 1373
  author: Ivan Palamarchuk
  author_email: i.delef@gmail.com
  author_url: ''
  date: '2013-11-21 05:21:41 +0000'
  date_gmt: '2013-11-21 13:21:41 +0000'
  content: thank you, guys!)
- id: 1379
  author: Marko
  author_email: info@embee-music.de
  author_url: http://www.embee-music.de/
  date: '2013-11-21 07:25:32 +0000'
  date_gmt: '2013-11-21 15:25:32 +0000'
  content: |-
    What about WordPress? It's not in the list, but I remember a graph which said "9x% passing".

    I would love to finally switch my blog to HHVM. I haven't seen any crashes so far, but I would sleep better with 100% unit tests passing.
- id: 1385
  author: Nathan Malcolm
  author_email: nmalcolm@hush.ai
  author_url: ''
  date: '2013-11-21 07:49:55 +0000'
  date_gmt: '2013-11-21 15:49:55 +0000'
  content: Brilliant. Looking forward to it. :)
- id: 1391
  author: Joel Marcey
  author_email: joelm@fb.com
  author_url: https://www.facebook.com/JoelMarcey
  date: '2013-11-21 08:07:41 +0000'
  date_gmt: '2013-11-21 16:07:41 +0000'
  content: |-
    Marko, we have been trying to automate our unit testing to run all the frameworks simultaneously. Wordpress requires some database setup and other things that make this automation a bit difficult right now. The 21 we have listed were a bit easier to automate the unit testing.

    That said, Wordpress does work very well with HHVM. We are working on a blog post that discusses some results with Wordpress and FastCGI.
- id: 1397
  author: Nazar Mokrynskyi
  author_email: nazar-pc@yandex.ru
  author_url: http://cleverstyle.org
  date: '2013-11-23 18:12:30 +0000'
  date_gmt: '2013-11-24 02:12:30 +0000'
  content: |-
    But it does not working. I get error:
    HipHop Fatal error: syntax error, unexpected '{' in &#47;web&#47;cscms.org&#47;www&#47;core&#47;functions.php on line 710

    Mentioned line in repository: https:&#47;&#47;github.com&#47;nazar-pc&#47;CleverStyle-CMS&#47;blob&#47;7b70604db2968fb642efc31efb3a874e831279f5&#47;core&#47;functions.php#L710
- id: 1403
  author: Nazar Mokrynskyi
  author_email: nazar-pc@yandex.ru
  author_url: http://cleverstyle.org
  date: '2013-11-23 18:17:46 +0000'
  date_gmt: '2013-11-24 02:17:46 +0000'
  content: |-
    I've created an issue on GitHub:
    https:&#47;&#47;github.com&#47;facebook&#47;hhvm&#47;issues&#47;1292
- id: 1409
  author: RouteXL
  author_email: info@routexl.com
  author_url: http://www.routexl.com/
  date: '2013-12-01 00:07:37 +0000'
  date_gmt: '2013-12-01 08:07:37 +0000'
  content: Looking forward to the resutts. Not only of the no shaving mantra, but
    also on the runtime. Will you be posting the post-lockdown post anytime soon?
- id: 1415
  author: Paul Tarjan
  author_email: pt@fb.com
  author_url: http://paultarjan.com/
  date: '2013-12-07 00:26:25 +0000'
  date_gmt: '2013-12-07 08:26:25 +0000'
  content: Yes, as soon as we cut the new release (should be next week).
- id: 1421
  author: Vassil Velichkov
  author_email: vassil.velichkov@sensika.com
  author_url: http://www.sensika.com
  date: '2013-12-12 07:01:29 +0000'
  date_gmt: '2013-12-12 15:01:29 +0000'
  content: |-
    Fingers crossed for a post-lockdown release and blog update before Christmas 2013 :-)

    Even a short blog update would be a gift :-)
- id: 1427
  author: Joel Marcey
  author_email: joelm@fb.com
  author_url: https://www.facebook.com/JoelMarcey
  date: '2013-12-12 10:55:08 +0000'
  date_gmt: '2013-12-12 18:55:08 +0000'
  content: We are preparing a post-lockdown post that should indeed be released before
    Christmas.
- id: 1433
  author: We are the 98.5% (and the 16%) &laquo; HipHop Virtual Machine
  author_email: ''
  author_url: http://www.hhvm.com/blog/2813/we-are-the-98-5-and-the-16
  date: '2013-12-19 09:38:44 +0000'
  date_gmt: '2013-12-19 17:38:44 +0000'
  content: "[&#8230;] November 4th, the HHVM team went on a 3-week performance and
    parity lockdown. The lockdown officially ended on November 22th. Overall, this
    lockdown was a qualified success. [&#8230;]"
- id: 1439
  author: Maxx
  author_email: gRungeddd.maxx@gmail.com
  author_url: ''
  date: '2014-01-04 06:55:49 +0000'
  date_gmt: '2014-01-04 14:55:49 +0000'
  content: Really an amazing work guys. The whole PHP community is looking forward
    for this boon. Many of us long time PHP users want HHVM to push the current code
    performance to several order of magnitude higher... Keep it up!
- id: 1445
  author: 'HHVM: The Next Six Months &laquo; HipHop Virtual Machine'
  author_email: ''
  author_url: http://www.hhvm.com/blog/3743/hhvm-the-next-six-months
  date: '2014-02-24 17:43:53 +0000'
  date_gmt: '2014-02-25 01:43:53 +0000'
  content: "[&#8230;] Lockdown improvements [&#8230;]"
- id: 1451
  author: Tomasz Grzemski
  author_email: t.grzemski@macopedia.pl
  author_url: http://macopedia.co/
  date: '2014-03-12 11:58:31 +0000'
  date_gmt: '2014-03-12 18:58:31 +0000'
  content: "We have some experience in starting TYPO3 Unit Tests on HHVM. \n\nCheck
    out post blog:\n<a href=\"http:&#47;&#47;blog.macopedia.co&#47;post&#47;running-typo3-cms-on-hhvm-part1&#47;\"
    rel=\"nofollow\">Running TYPO3 CMS on HHVM<&#47;a>"
- id: 45137
  author: Tymoteusz Motylewski
  author_email: t.motylewski@macopedia.pl
  author_url: http://blog.macopedia.co
  date: '2014-04-28 03:19:22 +0000'
  date_gmt: '2014-04-28 10:19:22 +0000'
  content: For current progress on having TYPO3 CMS unit tests run on HHVM see http:&#47;&#47;blog.macopedia.co&#47;en&#47;post&#47;running-typo3-cms-on-hhvm-part2
    . Now 95.57% are green. I will work on pusing a pull request for HHVM to include
    TYPO3 in parity testing.
- id: 301745
  author: Facebook&rsquo;s HHVM Speeds Up Box | CloudBackupCheap.com
  author_email: ''
  author_url: http://cloudbackupcheap.com/facebooks-hhvm-speeds-up-box/
  date: '2014-11-21 12:06:43 +0000'
  date_gmt: '2014-11-21 20:06:43 +0000'
  content: "[&#8230;] they have not interacted well with HHVM. But just under a year
    ago, the HHVM team&rsquo;s growing focus on parity&nbsp;with the standard PHP
    runtime caught our attention. We decided to seriously re-evaluate HHVM, [&#8230;]"
---

The HHVM team, along with our wonderful [open source](https://github.com/facebook/hhvm) contributors, is constantly trying to [improve the runtime](http://www.hhvm.com/blog/1301/hhvm-2-2-0). We know, however, that there is work to do to [run the world's PHP code reliably and consistently](http://www.hhvm.com/blog/875/wow-hhvm-is-fast-too-bad-it-doesnt-run-my-code).

<!--truncate-->

Every 6 months or so, the HHVM team goes into _lockdown_. Lockdown is a Facebook tradition where a team picks a few concentrated areas and pushes hard on them. The team is huddled together. No meetings. Specific task focused. Shaving is discouraged.

The HHVM team's latest Lockdown started on Monday. It is a 3-week effort focused entirely on two things: performance and parity.

![We want performance to rise even further](/static/images/posts/Screen-Shot-2013-11-06-at-5.16.45-PM1.png)
<center><i>We want performance to rise even further</i></center>

![We want to pass unit tests for as many frameworks as possible](/static/images/posts/Screen-Shot-2013-11-06-at-5.29.58-PM1.png)
<center><i>We want to pass unit tests for as many frameworks as possible</i></center>

The first graph is our performance graph. The second graph is our parity graph, and the percentages are unit tests passing per framework. Simply put, by the end of the three weeks, we want to have had each graph move up and to the right. (_Note_: The dip you see in the parity graph is our [unit test script](https://github.com/facebook/hhvm/tree/master/hphp/test/frameworks) misbehaving. The script is being continuously modified to make our testing better and more valuable).

The stickies below are an example of the individual tasks to get us there. We have prioritized them by impact (e.g., number of unit tests that will pass upon completion of the task) and length (how many days the task will take to complete). If these stickies are moved to the "Done" column, the graphs should respond favorably.

![If we finish these tasks, we will meet our parity goal](/static/images/posts/2013-10-31-17.33.041.jpg)
<center><i>If we finish these tasks, we will meet our parity goal</i></center>


The HHVM team really cares about maintaining a high quality runtime for PHP. At the end of the three weeks, the no shaving mantra having fully taken hold, we are hoping you see a much better HHVM in terms of being able to accurately run a broader array of PHP code, very fast. Stay tuned for the results of this lockdown.

![Here are some of the team members during the first week of lockdown. The no shaving mantra is being adhered to.](/static/images/posts/2013-11-07-14.11.131.jpg)
<center><i>Here are some of the team members during the first week of lockdown. The no shaving mantra is being adhered to.</i></center>
